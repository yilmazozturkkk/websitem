<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <link rel="icon" href="https://unpkg.com/boxicons@2.1.2/svg/regular/bx-qr-scan.svg" type="image/svg+xml">
  <title id="pageTitle">Barkod Sayım</title>
  <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css" rel="stylesheet">
<meta name="description" content="Yılmaz Öztürk - Microsoft Solutions Expert. Apps, BI, RPA, Dataverse, Copilot Studio, SharePoint ve daha fazlası için yenilikçi çözümler.">
  <meta name="keywords" content="Microsoft Solutions, Power Platform, Power Apps, Power BI, Power Automate, Power Pages, RPA, Dataverse, Copilot Studio, SharePoint">
  <meta name="author" content="Yılmaz Öztürk">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7R2WLSSPRD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-7R2WLSSPRD');
</script>
  
  <style>
    /* Stil tanımları aynı kalıyor */
    body {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      font-family: Poppins, sans-serif;
      margin: 0;
      padding: 0;
      background: #fff;
      touch-action: manipulation;
    }
   header {
      text-align: center;
      font-size: 1rem;
      padding: 0px;
      background-color: transparent;
    }
    .container {
      max-width: 100%;
      padding: 10px;
    }
    #qr-reader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 1000;
      background: rgba(0, 0, 0, 0.8);
      display: none;
    }
    #qr-reader video {
      width: 100% !important;
      height: auto !important;
      max-height: 100vh;
      object-fit: contain;
    }
    
    .form-section {
      margin-top: 15px;
    }
    .form-section .input-container {
      position: relative;
      width: 90%;
      max-width: 400px;
      margin: 15px auto;
    }
    .form-section input,
    .form-section textarea {
      padding: 12px;
      padding-right: 30px;
      margin: 4px 0;
      width: 100%;
      box-sizing: border-box;
      font-size: 1rem;
      border-radius: 10px;
      border: 1px solid #ccc;
      background-color: #f9f9f9;
    }
    .form-section .clear-btn {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 16px;
      color: #ccc;
      display: none;
    }
    .form-section input:not(:placeholder-shown) + .clear-btn,
    .form-section textarea:not(:placeholder-shown) + .clear-btn {
      display: block;
    }
    
    /* RADIO BUTON STİLLERİ (Küçültülmüş) */
    .form-section .radio-group {
      display: flex;
      justify-content: space-between;
      margin: 15px 0;
      gap: 5px;
    }
    .form-section .radio-group label {
      flex: 1;
      text-align: center;
      padding: 4px 2px;
      border: 1px solid #4682b4;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.7rem;
      user-select: none;
      transition: all 0.3s ease;
      background-color: #f8f9fa;
      color: #4682b4;
    }
    .form-section .radio-group input[type="radio"] {
      display: none;
    }
    .form-section .radio-group input[type="radio"]:checked + label {
      background-color: #4682b4;
      color: white;
      font-weight: normal;
    }
    
    /* TABLO STİLLERİ */
    table {
      overflow: hidden;
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
      margin-top: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      border: 1px solid #e0e0e0;
    }
  
    th, td {
      padding: 8px 10px;
      border-right: 1px solid #e0e0e0;
      border-bottom: 1px solid #e0e0e0;
    }
  
    th {
      background-color: #4682b4;
      color: white;
      text-align: left;
      position: sticky;
      top: 0;
      z-index: 10;
      border-bottom: 2px solid #3a6d99;
    }
    
    @media (max-width: 600px) {
      th, td {
        padding: 4px; 
      }
    }
    
    th:last-child, td:last-child {
      border-right: none;
    }
  
    tr:nth-child(even) {
      background-color: #f8f9fa;
    }
  
    tr:hover {
      background-color: #e9f5ff;
    }
    
    /* İŞLEM BUTONLARI */
    .action-buttons {
      display: flex;
      gap: 4px;
      justify-content: center;
      align-items: center;
      min-width: 80px;
    }

    .icon-btn {
      background: transparent;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 38px; 
      height: 38px; 
      display: flex;
      align-items: center;
      justify-content: center;
      color: #4682b4;
      transition: all 0.2s ease;
      font-size: 18px;
    }
    .icon-btn:hover {
      background-color: rgba(70, 130, 180, 0.2);
      transform: scale(1.1);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    @media (max-width: 600px) {
      .icon-btn {
        width: 32px; 
        height: 32px; 
        font-size: 16px; 
      }
    }
  
    /* Tablo hücrelerini ortala */
    td {
      vertical-align: middle;
    }   
    
    .warning {
      color: red;
      font-weight: bold;
    }
    .footer {
      background-color: transparent;
      padding: 5px;
      text-align: center;
    }
    .social-icons {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 5px;
    }
    .social-link {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: transparent;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #4682b4;
      font-size: 22px;
      text-decoration: none !important;
      transition: background-color 0.3s, transform 0.3s ease-in-out, color 0.3s ease-in-out;
    }
    .social-link:hover {
      background-color: #4682b4;
      color: #fff;
      transform: scale(1.15);
    }
    .social-link:hover i {
      transform: rotate(-10deg) scale(1.3);
    }
    .social-link[href*="linkedin"]:hover {
      background-color: #0077b5;
    }
    .social-link[href*="wa.me"]:hover {
      background-color: #25D366;
    }
    .social-link[href*="teams"]:hover {
      background-color: #6264A7;
    }
    .social-link[href*="mailto"]:hover {
      background-color: #EA4335;
    }
    .social-link[href*="tel"]:hover {
      background-color: #34B7F1;
    }
    .social-link[href*="innovativesolutions.com.tr"]:hover {
      background-color: #ff8c00;
    }
    .social-link[href*="logic.azure.com"]:hover {
      background-color: #3b5998;
    }
    .footer-info p {
      margin-top: 10px;
      font-size: 14px;
      color: #6c757d;
    }
    
    /* BUTON SATIRI (Güncellenmiş) */
    .button-row {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 15px auto;
      max-width: 400px;
    }
    
    /* BUTON KONTEYNER STİLLERİ (Güncellenmiş) */
    .button-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgba(70, 130, 180, 0.1);
      border: 1px solid rgba(70, 130, 180, 0.3);
      border-radius: 10px;
      padding: 6px;
      width: 60px;
      transition: all 0.2s ease;
    }
    
    .button-container:hover {
      background-color: rgba(70, 130, 180, 0.2);
    }
.button-container button i {
      font-size: 22px !important; 
    }
    .button-container button {
      background: transparent;
      border: none;
      cursor: pointer;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #4682b4;
      padding: 0;
      
    }

    .button-container .button-text {
      font-size: 10px;
      margin-top: 4px;
      color: #4682b4;
      text-align: center;
      font-weight: 500;
    }
    
    .auto-scan-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      margin-left: 10px;
    }
    .auto-scan-toggle label {
      display: flex;
      align-items: center;
      cursor: pointer;
      font-size: 14px;
      color: #4682b4;
    }
    .auto-scan-toggle .toggle-switch {
      position: relative;
      display: inline-block;
      width: 40px;
      height: 20px;
      margin-left: 5px;
    }
    .auto-scan-toggle .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .auto-scan-toggle .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: red;
      transition: .4s;
      border-radius: 20px;
    }
    .auto-scan-toggle .slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 2px;
      bottom: 2px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    .auto-scan-toggle input:checked + .slider {
      background-color: green;
    }
    .auto-scan-toggle input:checked + .slider:before {
      transform: translateX(20px);
    }
    .scanner-btn-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 15px;
    }
    .scanner-btn {
      background-color: #4682b4;
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }
    .scanner-btn:hover {
      background-color: #3a6d99;
      transform: scale(1.05);
    }
    .scanner-btn.active {
      background-color: #ff4757;
    }
    .scanner-btn-text {
      margin-top: 5px;
      font-size: 14px;
      color: #4682b4;
      font-weight: bold;
    }
    @media (max-width: 600px) {
      .form-section input, .form-section button, .form-section textarea {
        font-size: 1rem;
        padding: 10px;
      }
      table {
        font-size: 0.5rem;
      }
      th, td {
        padding: 2px;
      }
      .form-section input, .form-section button {
        font-size: 0.5rem;
      }
      #qr-reader {
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
      }
      .button-row {
        flex-wrap: wrap;
      }
      .auto-scan-toggle {
       min-height: 5vh; 
       margin: 0px;
       padding: 0;
       margin-left: 0;
       margin-top: 5px;
       width: 100%;
       justify-content: flex-center;
      }
      
      /* Mobilde radio butonları daha küçük */
      .form-section .radio-group label {
        font-size: 0.6rem;
        padding: 2px 1px;
      }
    }
    .search-container {
      display: flex;
      justify-content: center;
      position: relative;
      width: 90%;
      max-width: 300px;
      margin: 10px auto;
    }
    #searchInput {
      width: 100%;
      padding: 8px;
      padding-right: 30px;
      box-sizing: border-box;
      border-radius: 10px;
      border: 1px solid #ccc;
      background-color: #f9f9f9;
    }
    input, textarea {
      font-size: 16px !important;
    }

    /* Mail gönder popup stili */
    .mail-popup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }
    
    .mail-popup-content {
      background-color: white;
      align-items: center;
      justify-content: center;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 300px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .mail-popup h3 {
      margin-top: 0;
      color: #4682b4;
    }
    
    .mail-form-group {
      margin-bottom: 15px;
    }
    
    .mail-form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    
    .mail-form-group input,
    .mail-form-group textarea {
      width: 90%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
    }
    
    .mail-form-group textarea {
      min-height: 100px;
    }
    
    .mail-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 20px;
    }
    
    .mail-buttons button {
      padding: 8px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 14px;
    }
    
    .mail-send-btn {
      background-color: #4682b4;
      color: white;
    }
    
    .mail-cancel-btn {
      background-color: #f0f0f0;
      color: #333;
    }
    
    * {
      margin: 0;
      padding: 0;
      font-family: 'Poppins', sans-serif;
    }

    /* uzmanlık alanları animasyonu */
    .home_body h2 {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      min-height: 3vh; 
      margin: 5px;
      padding: 0;
      font-size: 14px;
    }

    .home_body h2 span {
      align-items: center;
      justify-content: center;
      position: relative;
      display: inline-block;
      color: transparent;
      -webkit-text-stroke: 0.7px #4682b4;
      animation: display-text 16s linear infinite;
      animation-delay: calc(-4s * var(--i));
    }

    @keyframes display-text {
      25%,
      100% {
        display: none;
      }
    }

    .home_body h2 span::before {
      align-items: center;
      justify-content: center;
      content: attr(data-text);
      position: absolute;
      width: 0;
      border-right: 2px solid #4682b4;
      color: #4682b4;
      white-space: nowrap;
      overflow: hidden;
      animation: fill-text 4s linear infinite;
    }
  
    @keyframes fill-text {
      10%,
      100% {
        width: 0;
      }
      70%,
      90% {
        width: 100%;
      }
    }

    /* Scroll çubuğu stil */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
  
    
    
  </style>
</head>
<body>

<div class="container">
  <div class="scanner-btn-container">
    <button id="toggleScannerBtn" onclick="toggleScanner()" class="scanner-btn" title="">
      <i id="toggleScannerIcon" class='bx bx-scan'></i>
    </button>
    <div id="scannerBtnText" class="scanner-btn-text"></div>
  </div>

  <div id="qr-reader"></div>

  <div class="form-section">
    <div class="input-container">
      <input type="text" id="barcodeInput" placeholder="" />
      <button class="clear-btn" onclick="clearInput('barcodeInput')">×</button>
    </div>
    
    <div class="input-container">
      <input type="number" id="quantityInput" placeholder="" inputmode="numeric" />
      <button class="clear-btn" onclick="clearInput('quantityInput')">×</button>
    </div>
    
    <div class="input-container">
      <input type="text" id="descriptionInput" placeholder="" />
      <button class="clear-btn" onclick="clearInput('descriptionInput')">×</button>
    </div>
    
    <div class="radio-group">
      <input type="radio" name="unit" id="dsp" value="DSP"/><label for="dsp">DSP</label>
      <input type="radio" name="unit" id="ea" value="EA" checked /><label for="ea">EA</label>
      <input type="radio" name="unit" id="cs" value="CS"/><label for="cs">CS</label>
      <input type="radio" name="unit" id="pal" value="PAL"/><label for="pal">PAL</label>
    </div>
    
    <div class="button-row">
      <div class="button-container">
        <button onclick="saveRecord()" title=""><i class='bx bx-save' ></i></button>
        <div class="button-text"></div>
      </div>
      <div class="button-container">
        <button onclick="deleteAllRecords()" title=""><i class="bi bi-trash-fill"></i></button>
        <div class="button-text"></div>
      </div>
      <div class="button-container">
        <button onclick="exportToExcel()" title=""><i class='bx bxs-download' ></i></button>
        <div class="button-text"></div>
      </div>
      <div class="button-container">
        <button onclick="showMailPopup()" title=""><i class='bx bx-mail-send'></i></button>
        <div class="button-text"></div>
      </div>
    </div>
  </div>
  
  <div class="auto-scan-toggle">
    <label>
      <span id="autoScanLabel">Auto Scan</span>
      <div class="toggle-switch">
        <input type="checkbox" id="autoCameraCheckbox" checked />
        <span class="slider"></span>
      </div>
    </label>
  </div>
      
  <div class="home_body">               
    <h2 class="home_title">
      <span style="--i:4;" data-text=""></span>
      <span style="--i:3;" data-text=""></span>
      <span style="--i:2;" data-text=""></span>
      <span style="--i:1;" data-text=""></span>
    </h2>                
  </div>    
      
  <div class="form-section">
    <div class="search-container">
      <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="">
      <button class="clear-btn" onclick="clearSearch()">×</button>
    </div>
  </div>
  
  <!-- Mail Gönder Popup Formu -->
  <div id="mailPopup" class="mail-popup">
    <div class="mail-popup-content">
      <h3><i class='bx bx-mail-send'></i> <span id="mailPopupTitle"></span></h3>
      <form id="mailForm">
        <div class="mail-form-group">
          <label for="mailTo" id="mailToLabel"></label>
          <input type="email" id="mailTo" required placeholder="">
        </div>
        <div class="mail-form-group">
          <label for="mailSubject" id="mailSubjectLabel"></label>
          <input type="text" id="mailSubject" required placeholder="">
        </div>
        <div class="mail-form-group">
          <label for="mailBody" id="mailBodyLabel"></label>
          <textarea id="mailBody" placeholder=""></textarea>
        </div>
        <div class="mail-buttons">
          <button type="button" onclick="hideMailPopup()" class="mail-cancel-btn">
            <i class='bx bx-x'></i> <span id="mailCancelText"></span>
          </button>
          <button type="button" onclick="sendMail()" class="mail-send-btn">
            <i class='bx bx-send'></i> <span id="mailSendText"></span>
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <table id="recordsTable">
    <thead>
      <tr>
        <th onclick="sortTable(0)">#</th>
        <th onclick="sortTable(1)" id="barcodeHeader"></th>
        <th onclick="sortTable(2)" id="quantityHeader"></th>
        <th onclick="sortTable(3)" id="unitHeader"></th>
        <th onclick="sortTable(4)" id="descriptionHeader"></th>
        <th onclick="sortTable(5)" id="datetimeHeader"></th>
        <th onclick="sortTable(6)" id="statusHeader"></th>
        <th id="actionHeader"></th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<footer class="footer">
  <div class="footer-inner">
    <div class="social-icons">
      <a href="https://www.linkedin.com/in/y%C4%B1lmaz%C3%B6zt%C3%BCrk?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=ios_app" class="social-link"><i class='bx bxl-linkedin'></i></a>
      <a href="https://www.innovativesolutions.com.tr" class="social-link"><i class='bx bxl-edge'></i></a>
      <a href="mailto:yilmaz.ozturk@outlook.com.tr" class="social-link"><i class='bx bx-mail-send'></i></a>
      <a href="tel:05321330110" class="social-link"><i class='bx bxs-phone-call'></i></a>
      <a href="https://teams.microsoft.com/l/chat/0/0?users=yilmaz.ozturk@outlook.com.tr" class="social-link"><i class='bx bxl-microsoft-teams'></i></a>
      <a href="https://wa.me/+905321330110?text=Merhaba!%20INNOVEXA%20olarak%20yenilikçi%20ve%20hızlı%20çözümler%20sunuyoruz.%20Size%20nasıl%20yardımcı%20olabiliriz?" class="social-link"><i class='bx bxl-whatsapp'></i></a>
      <a href="https://www.innovativesolutions.com.tr/Kartvizit" class="social-link"><i class='bx bx-id-card'></i></a>
    </div>

    <div class="footer-info">
      <p><span id="footerText"></span> <a href="https://www.innovativesolutions.com.tr" target="_blank"><strong>Yılmaz Öztürk</strong></a> <span id="footerText2"></span> &copy; <span id="year"></span></p>
    </div>
  </div>
</footer>

<script>
  // Dil desteği için çoklu dil nesnesi
  const translations = {
    tr: {
      pageTitle: "Barkod Sayım",
      barcodePlaceholder: "Barkod",
      quantityPlaceholder: "Miktar",
      descriptionPlaceholder: "Açıklama",
      saveBtn: "Kaydet",
      deleteBtn: "Sil",
      exportBtn: "İndir",
      mailBtn: "Mail",
      scannerBtnText: "BAŞLAT",
      scannerBtnStopText: "DURDUR",
      scannerBtnTitleStart: "Kamerayı Başlat",
      scannerBtnTitleStop: "Kamerayı Durdur",
      autoScanLabel: "Otomatik Tarama",
      searchPlaceholder: "🔍 Tabloda Ara...",
      tableHeaders: ["#", "Barkod", "Miktar", "Ölçü Birimi", "Açıklama", "Tarih/Saat", "Durum", "İşlem"],
      statusNew: "Yeni",
      statusRepeat: "Tekrar",
      statusEdited: "Düzeltildi",
      mailPopupTitle: "Excel Dosyasını Gönder",
      mailToLabel: "Kime:",
      mailToPlaceholder: "alici@ornek.com",
      mailSubjectLabel: "Konu:",
      mailSubjectPlaceholder: "Barkod Sayım Raporu",
      mailBodyLabel: "Açıklama:",
      mailBodyPlaceholder: "Ekte barkod sayım raporu bulunmaktadır.",
      mailCancelText: "Vazgeç",
      mailSendText: "Gönder",
      footerText1: "Bu araç,",
      footerText2: "tarafından geliştirilmiştir.",
      homeTexts: ["START'a dokun", "Barkodu okut", "Miktarı gir", "Kaydet"],
      alertMessages: {
        requiredFields: "Barkod ve miktar zorunludur.",
        confirmDeleteAll: "Tüm kayıtlar silinsin mi?",
        confirmDelete: "Bu kaydı silmek istiyor musunuz?",
        noRecords: "Gönderilecek kayıt bulunamadı!",
        emailRequired: "Lütfen alıcı e-posta adresini giriniz!",
        emailSent: "E-posta başarıyla gönderildi!",
        emailError: "E-posta gönderilirken bir hata oluştu:"
      }
    },
    en: {
      pageTitle: "Barcode Scanner",
      barcodePlaceholder: "Barcode",
      quantityPlaceholder: "Quantity",
      descriptionPlaceholder: "Description",
      saveBtn: "Save",
      deleteBtn: "Delete",
      exportBtn: "Export",
      mailBtn: "Email",
      scannerBtnText: "START",
      scannerBtnStopText: "STOP",
      scannerBtnTitleStart: "Start Camera",
      scannerBtnTitleStop: "Stop Camera",
      autoScanLabel: "Auto Scan",
      searchPlaceholder: "🔍 Search in table...",
      tableHeaders: ["#", "Barcode", "Quantity", "Unit", "Description", "Date/Time", "Status", "Action"],
      statusNew: "New",
      statusRepeat: "Repeat",
      statusEdited: "Edited",
      mailPopupTitle: "Send Excel File",
      mailToLabel: "To:",
      mailToPlaceholder: "recipient@example.com",
      mailSubjectLabel: "Subject:",
      mailSubjectPlaceholder: "Barcode Scan Report",
      mailBodyLabel: "Message:",
      mailBodyPlaceholder: "Please find the barcode scan report attached.",
      mailCancelText: "Cancel",
      mailSendText: "Send",
      footerText1: "This tool is developed by",
      footerText2: "",
      homeTexts: ["Touch START", "Scan barcode", "Enter quantity", "Save"],
      alertMessages: {
        requiredFields: "Barcode and quantity are required.",
        confirmDeleteAll: "Delete all records?",
        confirmDelete: "Are you sure you want to delete this record?",
        noRecords: "No records found to send!",
        emailRequired: "Please enter recipient email address!",
        emailSent: "Email sent successfully!",
        emailError: "An error occurred while sending email:"
      }
    },
    de: {
      pageTitle: "Barcode Scanner",
      barcodePlaceholder: "Barcode",
      quantityPlaceholder: "Menge",
      descriptionPlaceholder: "Beschreibung",
      saveBtn: "Speichern",
      deleteBtn: "Löschen",
      exportBtn: "Exportieren",
      mailBtn: "E-Mail",
      scannerBtnText: "BEGINNEN",
      scannerBtnStopText: "ANHALTEN",
      scannerBtnTitleStart: "Kamera starten",
      scannerBtnTitleStop: "Kamera stoppen",
      autoScanLabel: "Automatischer Scan",
      searchPlaceholder: "🔍 In Tabelle suchen...",
      tableHeaders: ["#", "Barcode", "Menge", "Einheit", "Beschreibung", "Datum/Zeit", "Status", "Aktion"],
      statusNew: "Neu",
      statusRepeat: "Wiederholen",
      statusEdited: "Bearbeitet",
      mailPopupTitle: "Excel-Datei senden",
      mailToLabel: "An:",
      mailToPlaceholder: "empfänger@beispiel.de",
      mailSubjectLabel: "Betreff:",
      mailSubjectPlaceholder: "Barcode-Scan-Bericht",
      mailBodyLabel: "Nachricht:",
      mailBodyPlaceholder: "Anbei finden Sie den Barcode-Scan-Bericht.",
      mailCancelText: "Abbrechen",
      mailSendText: "Senden",
      footerText1: "Dieses Tool wurde entwickelt von",
      footerText2: "",
      homeTexts: ["START berühren", "Barcode scannen", "Menge eingeben", "Speichern"],
      alertMessages: {
        requiredFields: "Barcode und Menge sind erforderlich.",
        confirmDeleteAll: "Alle Datensätze löschen?",
        confirmDelete: "Möchten Sie diesen Datensatz wirklich löschen?",
        noRecords: "Keine Datensätze zum Senden gefunden!",
        emailRequired: "Bitte geben Sie die Empfänger-E-Mail-Adresse ein!",
        emailSent: "E-Mail wurde erfolgreich gesendet!",
        emailError: "Fehler beim Senden der E-Mail:"
      }
    },
    fr: {
      pageTitle: "Scanner de Code-barres",
      barcodePlaceholder: "Code-barres",
      quantityPlaceholder: "Quantité",
      descriptionPlaceholder: "Description",
      saveBtn: "Enregistrer",
      deleteBtn: "Supprimer",
      exportBtn: "Exporter",
      mailBtn: "Email",
      scannerBtnText: "DÉMARRER",
      scannerBtnStopText: "ARRÊTER",
      scannerBtnTitleStart: "Démarrer la caméra",
      scannerBtnTitleStop: "Arrêter la caméra",
      autoScanLabel: "Scan automatique",
      searchPlaceholder: "🔍 Rechercher dans le tableau...",
      tableHeaders: ["#", "Code-barres", "Quantité", "Unité", "Description", "Date/Heure", "Statut", "Action"],
      statusNew: "Nouveau",
      statusRepeat: "Répéter",
      statusEdited: "Modifié",
      mailPopupTitle: "Envoyer un fichier Excel",
      mailToLabel: "À:",
      mailToPlaceholder: "destinataire@exemple.com",
      mailSubjectLabel: "Sujet:",
      mailSubjectPlaceholder: "Rapport de scan de code-barres",
      mailBodyLabel: "Message:",
      mailBodyPlaceholder: "Veuillez trouver ci-joint le rapport de scan de code-barres.",
      mailCancelText: "Annuler",
      mailSendText: "Envoyer",
      footerText1: "Cet outil est développé par",
      footerText2: "",
      homeTexts: ["Appuyez sur DÉMARRER", "Scannez le code-barres", "Entrez la quantité", "Enregistrer"],
      alertMessages: {
        requiredFields: "Le code-barres et la quantité sont obligatoires.",
        confirmDeleteAll: "Supprimer tous les enregistrements?",
        confirmDelete: "Voulez-vous vraiment supprimer cet enregistrement?",
        noRecords: "Aucun enregistrement trouvé à envoyer!",
        emailRequired: "Veuillez entrer l'adresse e-mail du destinataire!",
        emailSent: "E-mail envoyé avec succès!",
        emailError: "Une erreur s'est produite lors de l'envoi de l'e-mail:"
      }
    }
  };

  // Tarayıcı dilini algıla ve uygun dili seç
  function detectLanguage() {
    const browserLang = navigator.language || navigator.userLanguage;
    const langCode = browserLang.split('-')[0];
    
    // Desteklenen diller: tr, en, de, fr
    const supportedLangs = ['tr', 'en', 'de', 'fr'];
    const defaultLang = 'tr';
    
    return supportedLangs.includes(langCode) ? langCode : defaultLang;
  }

  // Sayfa dilini ayarla
  function setPageLanguage(lang) {
    const langData = translations[lang] || translations['tr'];
    
    // Başlık ve diğer metinleri güncelle
    document.getElementById('pageTitle').textContent = langData.pageTitle;
    document.getElementById('barcodeInput').placeholder = langData.barcodePlaceholder;
    document.getElementById('quantityInput').placeholder = langData.quantityPlaceholder;
    document.getElementById('descriptionInput').placeholder = langData.descriptionPlaceholder;
    document.getElementById('searchInput').placeholder = langData.searchPlaceholder;
    document.getElementById('autoScanLabel').textContent = langData.autoScanLabel;
    document.getElementById('scannerBtnText').textContent = langData.scannerBtnText;
    document.getElementById('toggleScannerBtn').title = langData.scannerBtnTitleStart;
    document.getElementById('mailPopupTitle').textContent = langData.mailPopupTitle;
    document.getElementById('mailToLabel').textContent = langData.mailToLabel;
    document.getElementById('mailTo').placeholder = langData.mailToPlaceholder;
    document.getElementById('mailSubjectLabel').textContent = langData.mailSubjectLabel;
    document.getElementById('mailSubject').placeholder = langData.mailSubjectPlaceholder;
    document.getElementById('mailBodyLabel').textContent = langData.mailBodyLabel;
    document.getElementById('mailBody').placeholder = langData.mailBodyPlaceholder;
    document.getElementById('mailCancelText').textContent = langData.mailCancelText;
    document.getElementById('mailSendText').textContent = langData.mailSendText;
    document.getElementById('footerText').textContent = langData.footerText1;
    document.getElementById('footerText2').textContent = langData.footerText2;
    
    // Tablo başlıklarını güncelle
    const tableHeaders = document.querySelectorAll('#recordsTable th');
    langData.tableHeaders.forEach((header, index) => {
      if (index < tableHeaders.length) {
        tableHeaders[index].textContent = header;
      }
    });
    
    // Buton metinlerini güncelle
    const buttonTexts = [
      langData.saveBtn,
      langData.deleteBtn,
      langData.exportBtn,
      langData.mailBtn
    ];
    
    const buttonContainers = document.querySelectorAll('.button-text');
    buttonTexts.forEach((text, index) => {
      if (index < buttonContainers.length) {
        buttonContainers[index].textContent = text;
      }
    });
    
    // Buton tooltip'lerini güncelle
    const buttonTitles = [
      langData.saveBtn,
      langData.deleteBtn,
      langData.exportBtn,
      langData.mailBtn
    ];
    
    const buttons = document.querySelectorAll('.button-container button');
    buttonTitles.forEach((title, index) => {
      if (index < buttons.length) {
        buttons[index].title = title;
      }
    });
    
    // Anasayfa metinlerini güncelle
    const homeTextSpans = document.querySelectorAll('.home_title span');
    langData.homeTexts.forEach((text, index) => {
      if (index < homeTextSpans.length) {
        homeTextSpans[index].textContent = text;
        homeTextSpans[index].setAttribute('data-text', text);
      }
    });
    
    // Dil ayarını localStorage'a kaydet
    localStorage.setItem('preferredLanguage', lang);
    
    return langData;
  }

  // Uygulama başlatma
  let currentLangData;
  let records = JSON.parse(localStorage.getItem("barcodeRecords")) || [];
  let editIndex = -1;
  let scannerActive = false;
  let html5QrCode;
  let autoCameraEnabled = localStorage.getItem("autoCameraEnabled") !== "false";

  // Sayfa yüklendiğinde ayarları yükle
  document.addEventListener('DOMContentLoaded', () => {
    // Kullanıcının tercih ettiği dili kontrol et (localStorage'da varsa)
    const preferredLanguage = localStorage.getItem('preferredLanguage') || detectLanguage();
    currentLangData = setPageLanguage(preferredLanguage);
    
    displayRecords();
    document.getElementById("quantityInput").setAttribute("inputmode", "numeric");
    document.getElementById("autoCameraCheckbox").checked = autoCameraEnabled;
  });

  // Input temizleme fonksiyonu
  function clearInput(inputId) {
    document.getElementById(inputId).value = "";
    document.getElementById(inputId).focus();
  }

  // Otomatik kamera ayarını değiştir
  document.getElementById("autoCameraCheckbox").addEventListener('change', function() {
    autoCameraEnabled = this.checked;
    localStorage.setItem("autoCameraEnabled", autoCameraEnabled);
  });

  // Kamera tarayıcısını açıp kapatan fonksiyon
  async function toggleScanner() {
    const qrRegionId = "qr-reader";
    const toggleBtn = document.getElementById("toggleScannerBtn");
    const toggleIcon = document.getElementById("toggleScannerIcon");
    const scannerText = document.getElementById("scannerBtnText");

    if (!scannerActive) {
      html5QrCode = new Html5Qrcode(qrRegionId);
      
      const config = {
        fps: 15,
        qrbox: { width: 320, height: 450 },
        aspectRatio: 1.333,
        supportedScanTypes: [Html5QrcodeScanType.SCAN_TYPE_CAMERA],
        formatsToSupport: [
          Html5QrcodeSupportedFormats.UPC_A,
          Html5QrcodeSupportedFormats.UPC_E,
          Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION,
          Html5QrcodeSupportedFormats.EAN_8,
          Html5QrcodeSupportedFormats.EAN_13,
          Html5QrcodeSupportedFormats.CODE_39,
          Html5QrcodeSupportedFormats.CODE_93,
          Html5QrcodeSupportedFormats.CODE_128,
          Html5QrcodeSupportedFormats.CODABAR,
          Html5QrcodeSupportedFormats.ITF,
          Html5QrcodeSupportedFormats.ITF_14,
          Html5QrcodeSupportedFormats.MSI,
          Html5QrcodeSupportedFormats.PLESSEY,
          Html5QrcodeSupportedFormats.QR_CODE,
          Html5QrcodeSupportedFormats.DATA_MATRIX,
          Html5QrcodeSupportedFormats.AZTEC,
          Html5QrcodeSupportedFormats.PDF_417,
          Html5QrcodeSupportedFormats.MAXICODE,
          Html5QrcodeSupportedFormats.RSS_14,
          Html5QrcodeSupportedFormats.RSS_EXPANDED,
          Html5QrcodeSupportedFormats.JAN,
          Html5QrcodeSupportedFormats.IATA_2OF5
        ],
        videoConstraints: {
          facingMode: "environment",
          width: { ideal: 1920 },
          height: { ideal: 1080 },
          focusMode: "continuous",
          transform:"none",
          advanced: [
            { zoom: 2.5 },
            { torch: false }
          ]
        }
      };

      try {
        document.getElementById(qrRegionId).style.display = "block";
        await html5QrCode.start(
          { facingMode: "environment" },
          config,
          (decodedText) => {
            document.getElementById("barcodeInput").value = decodedText;
            stopScanner();
          },
          (errorMessage) => {
            console.log("QR Code error:", errorMessage);
          }
        );
        scannerActive = true;
        toggleBtn.classList.add("active");
        toggleIcon.className = 'bx bx-stop-circle';
        scannerText.textContent = currentLangData.scannerBtnStopText;
        toggleBtn.title = currentLangData.scannerBtnTitleStop;
      } catch (err) {
        console.error("Kamera başlatılamadı:", err);
        document.getElementById(qrRegionId).style.display = "none";
      }
    } else {
      await stopScanner();
    }
  }

  // Tarayıcıyı durdur
  async function stopScanner() {
    if (html5QrCode && scannerActive) {
      try {
        await html5QrCode.stop();
        document.getElementById("qr-reader").style.display = "none";
        scannerActive = false;
        
        const toggleBtn = document.getElementById("toggleScannerBtn");
        const toggleIcon = document.getElementById("toggleScannerIcon");
        const scannerText = document.getElementById("scannerBtnText");
        
        toggleBtn.classList.remove("active");
        toggleIcon.className = 'bx bx-scan';
        scannerText.textContent = currentLangData.scannerBtnText;
        toggleBtn.title = currentLangData.scannerBtnTitleStart;
      } catch (err) {
        console.error("Tarayıcı durdurulurken hata:", err);
      }
    }
  }

  // Kayıt ekleme/düzenleme fonksiyonu
  function saveRecord() {
    const barcode = document.getElementById("barcodeInput").value.trim();
    const quantity = document.getElementById("quantityInput").value.trim();
    const unit = document.querySelector("input[name='unit']:checked")?.value || "";
    const description = document.getElementById("descriptionInput").value.trim();

    if (!barcode || !quantity) {
      alert(currentLangData.alertMessages.requiredFields);
      return;
    }

    const now = new Date();
    const datetime = now.toLocaleString(navigator.language);

    const existingIndex = records.findIndex(r => r.barcode === barcode);
    let status = existingIndex >= 0 ? currentLangData.statusRepeat : currentLangData.statusNew;
    if (editIndex >= 0) status = currentLangData.statusEdited;

    const record = { barcode, quantity, unit, description, datetime, status };

    if (editIndex >= 0) {
      records[editIndex] = record;
      editIndex = -1;
    } else {
      records.push(record);
    }

    localStorage.setItem("barcodeRecords", JSON.stringify(records));
    displayRecords();

    // Alanları temizle
    document.getElementById("barcodeInput").value = "";
    document.getElementById("quantityInput").value = "";
    document.getElementById("ea").checked = true;
    document.getElementById("descriptionInput").value = "";

    // Eğer otomatik kamera açık ise tarayıcıyı yeniden başlat
    if (autoCameraEnabled) {
      setTimeout(() => {
        toggleScanner();
      }, 300);
    }
  }

  // Kayıtları tabloda göster
  function displayRecords() {
    const tbody = document.querySelector("#recordsTable tbody");
    tbody.innerHTML = "";
    records.forEach((r, i) => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${i + 1}</td>
        <td>${r.barcode}</td>
        <td>${r.quantity}</td>
        <td>${r.unit}</td>
        <td>${r.description}</td>
        <td>${r.datetime || ""}</td>
        <td class="${r.status === currentLangData.statusRepeat ? 'warning' : ''}">${r.status}</td>
        <td class="action-buttons">
          <button class="icon-btn" onclick="editRecord(${i})" title="${currentLangData.tableHeaders[7]}">
            <i class="bi bi-pencil-square"></i>
          </button>
          <button class="icon-btn" onclick="deleteRecord(${i})" title="${currentLangData.deleteBtn}">
            <i class="bi bi-trash-fill"></i>
          </button>
        </td>`;
      tbody.appendChild(row);
    });
  }

  // Kayıt düzenle
  function editRecord(index) {
    const r = records[index];
    document.getElementById("barcodeInput").value = r.barcode;
    document.getElementById("quantityInput").value = r.quantity;
    document.querySelectorAll("input[name='unit']").forEach(input => {
      input.checked = input.value === r.unit;
    });
    document.getElementById("descriptionInput").value = r.description;
    editIndex = index;
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  // Tüm kayıtları sil
  function deleteAllRecords() {
    if (confirm(currentLangData.alertMessages.confirmDeleteAll)) {
      records = [];
      localStorage.removeItem("barcodeRecords");
      displayRecords();
    }
  }

  // Tek kayıt sil
  function deleteRecord(index) {
    if (confirm(currentLangData.alertMessages.confirmDelete)) {
      records.splice(index, 1);
      localStorage.setItem("barcodeRecords", JSON.stringify(records));
      displayRecords();
    }
  }

  // Excel'e aktar
  function exportToExcel() {
    const exportData = records.map((r, i) => ({
      [currentLangData.tableHeaders[0]]: i + 1,
      [currentLangData.tableHeaders[1]]: r.barcode,
      [currentLangData.tableHeaders[2]]: r.quantity,
      [currentLangData.tableHeaders[3]]: r.unit,
      [currentLangData.tableHeaders[4]]: r.description,
      [currentLangData.tableHeaders[5]]: r.datetime || "",
      [currentLangData.tableHeaders[6]]: r.status
    }));
    
    const worksheet = XLSX.utils.json_to_sheet(exportData);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, currentLangData.tableHeaders[1]);
    XLSX.writeFile(workbook, `barcode_records_${new Date().toISOString().slice(0,10)}.xlsx`);
  }

  // Tablo sıralama
  let sortOrder = {
    0: 'asc', 1: 'asc', 2: 'asc', 3: 'asc', 4: 'asc', 5: 'asc', 6: 'asc'
  };

  function sortTable(column) {
    const tbody = document.querySelector("#recordsTable tbody");
    const rows = Array.from(tbody.rows);
    const order = sortOrder[column] === 'asc' ? 1 : -1;

    rows.sort((a, b) => {
      const cellA = a.cells[column].innerText.trim();
      const cellB = b.cells[column].innerText.trim();

      if (column === 1 || column === 2 || column === 4) {
        return (cellA > cellB ? 1 : -1) * order;
      } else if (column === 5) {
        return (new Date(cellA) - new Date(cellB)) * order;
      } else {
        return (cellA > cellB ? 1 : -1) * order;
      }
    });

    sortOrder[column] = sortOrder[column] === 'asc' ? 'desc' : 'asc';
    tbody.innerHTML = '';
    rows.forEach(row => tbody.appendChild(row));
  }

  // Tablo arama
  function searchTable() {
    const query = document.getElementById('searchInput').value.toLowerCase();
    const rows = document.querySelectorAll('#recordsTable tbody tr');
    rows.forEach(row => {
      const cells = row.getElementsByTagName('td');
      let match = false;
      for (let i = 0; i < cells.length; i++) {
        if (cells[i].textContent.toLowerCase().includes(query)) {
          match = true;
          break;
        }
      }
      row.style.display = match ? '' : 'none';
    });
  }

  // Arama temizle
  function clearSearch() {
    document.getElementById("searchInput").value = "";
    searchTable();
  }

  // Mail popup'ını göster
  function showMailPopup() {
    if(records.length === 0) {
      alert(currentLangData.alertMessages.noRecords);
      return;
    }
    
    document.getElementById('mailPopup').style.display = 'flex';
    document.getElementById('mailSubject').value = `${currentLangData.mailSubjectPlaceholder} - ${new Date().toLocaleDateString(navigator.language)}`;
  }

  // Mail popup'ını gizle
  function hideMailPopup() {
    document.getElementById('mailPopup').style.display = 'none';
  }

  // Mail gönderme fonksiyonu
  async function sendMail() {
    const mailTo = document.getElementById('mailTo').value.trim();
    const mailSubject = document.getElementById('mailSubject').value.trim();
    const mailBody = document.getElementById('mailBody').value.trim();
    
    if(!mailTo) {
      alert(currentLangData.alertMessages.emailRequired);
      return;
    }
    
    const sendBtn = document.querySelector('.mail-send-btn');
    const originalText = sendBtn.innerHTML;
    sendBtn.innerHTML = `<i class="bx bx-loader bx-spin"></i> ${currentLangData.mailSendText}...`;
    sendBtn.disabled = true;
    
    try {
          // Excel dosyasını oluştur
      const exportData = records.map((r, i) => ({
        [currentLangData.tableHeaders[0]]: i + 1,
        [currentLangData.tableHeaders[1]]: r.barcode,
        [currentLangData.tableHeaders[2]]: r.quantity,
        [currentLangData.tableHeaders[3]]: r.unit,
        [currentLangData.tableHeaders[4]]: r.description,
        [currentLangData.tableHeaders[5]]: r.datetime || "",
        [currentLangData.tableHeaders[6]]: r.status
      }));
      
      const worksheet = XLSX.utils.json_to_sheet(exportData);
      const workbook = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(workbook, worksheet, currentLangData.tableHeaders[1]);
      
      // Excel dosyasını binary olarak oluştur
      const excelBinary = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });
      
      // Binary'yi base64'e çevir (optimize edilmiş versiyon)
      const excelBase64 = arrayBufferToBase64(excelBinary);
      
      // Kullanıcı ve cihaz bilgilerini topla
      const userAgentData = {
        device: navigator.userAgentData ? navigator.userAgentData.mobile ? 'mobile' : 'desktop' : 'unknown',
        platform: navigator.platform,
        language: navigator.language,
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
      };
      
      // Power Automate'e gönderilecek JSON verisi
      const payload = {
        metadata: {
          timestamp: new Date().toISOString(),
          source: window.location.hostname,
          language: navigator.language
        },
        headers: {
          "User-Agent": navigator.userAgent,
          "Accept-Language": navigator.language
        },
        body: {
          to: mailTo,
          subject: mailSubject,
          message: mailBody,
          attachment: {
            filename: `${currentLangData.mailSubjectPlaceholder.replace(/\s+/g, '_')}_${new Date().toISOString().slice(0,10)}.xlsx`,
            content: excelBase64,
            size: excelBinary.length,
            type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
          },
          userData: userAgentData
        }
      };
      
      console.log("Gönderilen veri:", payload); 
      
      // Hata ayıklama için
      
      const response = await fetch("https://prod-107.westeurope.logic.azure.com:443/workflows/d1cddc96e3a8441d814c1751c0fdad23/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=DHs479xtB9FY7hTxV7oKJkWeiL4qL0KyMtDPO1fNkwk", {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
      });
      
      if(response.ok) {
        alert(currentLangData.alertMessages.emailSent);
        hideMailPopup();
      } else {
        const errorData = await response.text();
        throw new Error(`${currentLangData.alertMessages.emailError} ${response.status} - ${errorData}`);
      }
    } catch (error) {
      console.error("Mail gönderme hatası:", error);
      alert(`${currentLangData.alertMessages.emailError}\n${error.message}`);
    } finally {
      sendBtn.innerHTML = originalText;
      sendBtn.disabled = false;
    }
  }

  // Binary array'i base64'e çevirme fonksiyonu (optimize edilmiş)
  function arrayBufferToBase64(buffer) {
    let binary = '';
    const bytes = new Uint8Array(buffer);
    const len = bytes.byteLength;
    for (let i = 0; i < len; i++) {
      binary += String.fromCharCode(bytes[i]);
    }
    return window.btoa(binary);
  }

  // Geliştirici araçlarını engelle
  document.addEventListener('contextmenu', e => e.preventDefault());
  document.addEventListener('keydown', e => {
    if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && ['I', 'C', 'J'].includes(e.key.toUpperCase()))) {
      e.preventDefault();
    }
  });

  // Ekran büyümesini engellemek için
  document.addEventListener('touchmove', function(e) {
    if(e.scale !== 1) { e.preventDefault(); }
  }, { passive: false });

  // Input alanlarına odaklanıldığında sayfanın büyümesini engelle
  document.querySelectorAll('input').forEach(input => {
    input.addEventListener('focus', function() {
      window.scrollTo(0, 0);
      document.body.style.zoom = "1.0";
    });
  });

  // Yıl bilgisini otomatik ekle
  document.getElementById('year').textContent = new Date().getFullYear();

  // Dil değiştirme butonları (isteğe bağlı)
  function addLanguageSwitcher() {
    const langSwitcher = document.createElement('div');
    langSwitcher.style.position = 'fixed';
    langSwitcher.style.top = '10px';
    langSwitcher.style.left = '10px';
    langSwitcher.style.zIndex = '1000';
    langSwitcher.style.display = 'flex';
    langSwitcher.style.gap = '5px';
    langSwitcher.style.background = 'rgba(255,255,255,0.8)';
    langSwitcher.style.padding = '5px';
    langSwitcher.style.borderRadius = '20px';
    langSwitcher.style.boxShadow = '0 2px 5px rgba(0,0,0,0.2)';
    
    const languages = [
      { code: 'tr', name: 'Türkçe', flag: '🇹🇷' },
      { code: 'en', name: 'English', flag: '🇬🇧' },
      { code: 'de', name: 'Deutsch', flag: '🇩🇪' },
      { code: 'fr', name: 'Français', flag: '🇫🇷' }
    ];
    
    languages.forEach(lang => {
      const btn = document.createElement('button');
      btn.textContent = lang.flag;
      btn.title = lang.name;
      btn.style.background = 'none';
      btn.style.border = 'none';
      btn.style.cursor = 'pointer';
      btn.style.fontSize = '20px';
      btn.style.padding = '2px';
      btn.style.borderRadius = '50%';
      btn.style.width = '30px';
      btn.style.height = '30px';
      btn.style.display = 'flex';
      btn.style.alignItems = 'center';
      btn.style.justifyContent = 'center';
      btn.style.transition = 'all 0.2s';
      
      btn.addEventListener('mouseover', () => {
        btn.style.transform = 'scale(1.1)';
        btn.style.backgroundColor = '#4682b4';
        btn.style.color = 'white';
      });
      
      btn.addEventListener('mouseout', () => {
        btn.style.transform = 'scale(1)';
        btn.style.backgroundColor = 'transparent';
        btn.style.color = 'inherit';
      });
      
      btn.addEventListener('click', () => {
        currentLangData = setPageLanguage(lang.code);
        displayRecords();
      });
      
      langSwitcher.appendChild(btn);
    });
    
    document.body.appendChild(langSwitcher);
  }
  // Sayfa yüklendiğinde ayarları yükle
  document.addEventListener('DOMContentLoaded', () => {
    const preferredLanguage = localStorage.getItem('preferredLanguage') || detectLanguage();
    currentLangData = setPageLanguage(preferredLanguage);
    
    displayRecords();
    document.getElementById("quantityInput").setAttribute("inputmode", "numeric");
    document.getElementById("autoCameraCheckbox").checked = autoCameraEnabled});
    
    // Dil değiştiriciyi ekle (isteğe bağlı)
    // addLanguageSwitcher(); // Bu satırı kaldırırsanız dil butonları görünmez
  addLanguageSwitcher();
</script>
</body>
</html>
